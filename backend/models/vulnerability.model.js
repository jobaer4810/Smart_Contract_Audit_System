/* Created by : Ali Mohammad Jobaer
Student ID : 103835483 */


// Exporting a function that defines and returns the Vulnerability model

module.exports = (sequelize, Sequelize) => {
        // Defining the Vulnerability model with its attributes and their data types

    const Vulnerability = sequelize.define("vulnerability", {

                // Primary key attribute - auto incrementing integer

                    vulnerability_id: {
                        type: Sequelize.INTEGER,
                        primaryKey: true,
                        autoIncrement: true
                    },
                    vulnerability_name: {
                        type: Sequelize.STRING(255),
                        allowNull: false
                    },
                    impact: {
                        type: Sequelize.ENUM('High', 'Medium', 'Low', 'Informational'),
                        allowNull: false
                    },
                    description: {
                        type: Sequelize.TEXT,
                        allowNull: false
                    },
                    location: {
                        type: Sequelize.STRING(255),
                        allowNull: true
                    },
                    confidence: {
                        type: Sequelize.ENUM('High', 'Medium', 'Low'),
                        allowNull: false
                    },
                    recommendation: {
                        type: Sequelize.TEXT,
                        allowNull: true,
                        defaultValue: "No recommendation found."
                    }
                });

                return Vulnerability;
            };
